<Window x:Class="WindowzTabManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Windowz"
        WindowStyle="None"
        ResizeMode="CanResize"
        MinWidth="400" MinHeight="300"
        Width="960" Height="680"
        WindowStartupLocation="CenterScreen"
        ShowInTaskbar="True"
        Background="#1E1E1E"
        LocationChanged="Window_LocationChanged">

    <Window.Resources>

        <!-- タイトルバーのウィンドウコントロールボタン -->
        <Style x:Key="WinCtrlButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#AAAAAA"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="46"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Arrow"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#3A3A3A"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 閉じるボタン (ホバー時に赤) -->
        <Style x:Key="WinCloseButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#AAAAAA"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="46"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Arrow"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#C42B1C"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- サイドバー内のボタン -->
        <Style x:Key="HeaderButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#AAAAAA"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}"
                                Padding="{TemplateBinding Padding}" CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#333333"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- + ボタン -->
        <Style x:Key="AddButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#888888"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" CornerRadius="3" Margin="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#333333"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="32"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- ===== タイトルバー ===== -->
        <Grid x:Name="TitleBar" Grid.Row="0" Background="#252526"
              MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Column="0" Style="{StaticResource HeaderButton}"
                    Content="≡" FontSize="16" Padding="10,0"
                    VerticalAlignment="Center"
                    Click="HamburgerButton_Click" ToolTip="メニュー"/>

            <TextBlock Grid.Column="1" Text="Windowz"
                       VerticalAlignment="Center" HorizontalAlignment="Center"
                       Foreground="#CCCCCC" FontFamily="Segoe UI"
                       FontSize="11" FontWeight="SemiBold"
                       IsHitTestVisible="False"/>

            <StackPanel Grid.Column="2" Orientation="Horizontal">
                <Button Content="—" Style="{StaticResource WinCtrlButton}"
                        Click="MinimizeButton_Click" ToolTip="最小化"/>
                <Button x:Name="MaxRestoreButton" Content="□" Style="{StaticResource WinCtrlButton}"
                        Click="MaximizeButton_Click" ToolTip="最大化/元に戻す"/>
                <Button Content="✕" Style="{StaticResource WinCloseButton}"
                        Click="CloseWindowButton_Click" ToolTip="閉じる"/>
            </StackPanel>
        </Grid>

        <!-- タイトルバー下のセパレーター -->
        <Rectangle Grid.Row="0" VerticalAlignment="Bottom" Height="1"
                   Fill="#3C3C3C" IsHitTestVisible="False"/>

        <!-- ===== メインコンテンツ (サイドバー | スプリッター | コンテンツエリア) ===== -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition x:Name="SidebarCol" Width="200" MinWidth="140" MaxWidth="500"/>
                <ColumnDefinition Width="4"/>
                <ColumnDefinition Width="*" MinWidth="100"/>
            </Grid.ColumnDefinitions>

            <!-- サイドバー -->
            <Grid Grid.Column="0" Background="#1E1E1E">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="1"/>
                    <RowDefinition Height="42"/>
                </Grid.RowDefinitions>

                <ScrollViewer Grid.Row="0"
                              VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Disabled"
                              Background="#1E1E1E">
                    <StackPanel x:Name="TabsPanel" Orientation="Vertical"/>
                </ScrollViewer>

                <Rectangle Grid.Row="1" Fill="#3C3C3C"/>

                <Button Grid.Row="2" Style="{StaticResource AddButton}"
                        Content="+" ToolTip="ウィンドウを追加 (Ctrl+T)"
                        Click="AddButton_Click"
                        VerticalAlignment="Stretch" HorizontalAlignment="Stretch"/>
            </Grid>

            <!-- グリッドスプリッター (サイドバー幅の調整) -->
            <GridSplitter Grid.Column="1"
                          HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                          Background="#2A2A2A" Cursor="SizeWE"
                          ShowsPreview="False"/>

            <!-- コンテンツエリア (他のアプリをここに配置) -->
            <Border x:Name="ContentAreaBorder" Grid.Column="2"
                    Background="#0D0D0D"
                    SizeChanged="ContentArea_SizeChanged">
                <TextBlock x:Name="EmptyHint"
                           Text="「＋」でウィンドウを追加   Ctrl+T"
                           Foreground="#2A2A2A" FontFamily="Segoe UI" FontSize="16"
                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
        </Grid>
    </Grid>

    <!-- コンテキストメニュー -->
    <Window.ContextMenu>
        <ContextMenu Background="#2D2D2D" BorderBrush="#3C3C3C" Foreground="#CCCCCC">
            <MenuItem Header="ウィンドウを追加..." Click="AddButton_Click"/>
            <Separator Background="#3C3C3C"/>
            <MenuItem Header="すべて解放" Click="ReleaseAllMenuItem_Click"/>
            <Separator Background="#3C3C3C"/>
            <MenuItem Header="終了" Click="CloseWindowButton_Click"/>
        </ContextMenu>
    </Window.ContextMenu>
</Window>

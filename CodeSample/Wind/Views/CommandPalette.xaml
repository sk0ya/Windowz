<UserControl x:Class="Wind.Views.CommandPalette"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             Width="500" MaxHeight="400"
             HorizontalAlignment="Center" VerticalAlignment="Top"
             Margin="0,60,0,0">

    <Border Background="{DynamicResource ApplicationBackgroundBrush}"
            BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}"
            BorderThickness="1" CornerRadius="8">
        <Border.Effect>
            <DropShadowEffect BlurRadius="16" ShadowDepth="2" Opacity="0.35" Color="Black"/>
        </Border.Effect>
        <Grid Margin="6">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Search Input -->
            <ui:TextBox x:Name="SearchBox"
                        PlaceholderText="Type a command..."
                        Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                        Icon="{ui:SymbolIcon Search24}"
                        Margin="0,0,0,4"
                        PreviewKeyDown="SearchBox_PreviewKeyDown"/>

            <!-- Results List -->
            <ListBox Grid.Row="1"
                     x:Name="ResultsList"
                     ItemsSource="{Binding ItemsView}"
                     SelectedItem="{Binding SelectedItem}"
                     IsSynchronizedWithCurrentItem="True"
                     Background="Transparent"
                     BorderThickness="0"
                     Padding="0"
                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                     MouseUp="ListBox_MouseUp">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid Margin="2,1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ui:SymbolIcon Symbol="{Binding Icon}"
                                           FontSize="14" Margin="0,0,8,0"
                                           VerticalAlignment="Center"
                                           Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                            <TextBlock Grid.Column="1" Text="{Binding Name}"
                                       VerticalAlignment="Center"
                                       TextTrimming="CharacterEllipsis"
                                       FontSize="13"
                                       Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                            <TextBlock Grid.Column="2" Text="{Binding Category}"
                                       VerticalAlignment="Center"
                                       FontSize="11"
                                       Foreground="{DynamicResource TextFillColorTertiaryBrush}"
                                       Margin="8,0,0,0"/>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <Setter Property="Padding" Value="6,3"/>
                        <Setter Property="Margin" Value="0"/>
                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                    </Style>
                </ListBox.ItemContainerStyle>
            </ListBox>
        </Grid>
    </Border>
</UserControl>

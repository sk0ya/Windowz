# Windowz

既存の Windows アプリケーションをタブとして束ねて管理できる、WPF 製のタブマネージャーです。

`SetParent` を使わず `SetWindowPos` で各アプリを Windowz のコンテンツ領域に重ねる方式のため、対象アプリのウィンドウ構造を変更せず、一般のアプリと同様に動作し続けます。

---

## 主な機能

| 機能 | 説明 |
|---|---|
| **ウィンドウのタブ化** | 動作中の任意のアプリを選択してタブに追加 |
| **Web タブ** | WebView2 ベースのブラウザタブを追加 |
| **スタートアップ起動** | 指定アプリを起動時に自動で埋め込み |
| **クイックランチ** | よく使うアプリをワンクリックで起動・追加 |
| **自動埋め込み** | 新しく現れたウィンドウを自動でタブに追加 |
| **タブ位置変更** | タブバーを上・下・左・右に切り替え |
| **タブグループ** | 色付きグループでタブを整理 |
| **グローバルホットキー** | アプリにフォーカスがなくてもキー操作でタブ切替 |
| **コマンドパレット** | `Alt+P` で機能をキーボードから呼び出し |

---

## 動作要件

- **OS**: Windows 10 / Windows 11
- **ランタイム**: .NET 8 Desktop Runtime
- **WebView2**: Microsoft Edge WebView2 Runtime（Web タブを使う場合）

---

## ビルド

```bash
dotnet restore Windowz/WindowzTabManager.csproj
dotnet build Windowz/WindowzTabManager.csproj
dotnet run --project Windowz/WindowzTabManager.csproj
```

出力は `Windowz/bin/Debug/net8.0-windows/` に生成されます。

---

## 使い方

### ウィンドウを追加する

1. ツールバー右の **＋** ボタン（または `Ctrl+T`）をクリック
2. ウィンドウピッカーで追加したいアプリを選択
3. Windowz のコンテンツ領域にそのアプリが表示される

タブをクリックするたびに対応するウィンドウが最前面に移動します。Windowz を最小化すると管理中のウィンドウもまとめて隠れ、復元すると再表示されます。

### Web タブを追加する

ウィンドウピッカー上部の URL 入力欄に URL を入力して追加します。

### スタートアップアプリを設定する

設定 → **スタートアップ** で起動時に自動で埋め込むアプリを登録します。URL を登録すると Web タブとして開きます。

### クイックランチを設定する

設定 → **クイックランチ** でよく使うアプリを登録しておくと、ウィンドウピッカーからワンクリックで起動・追加できます。

---

## デフォルトのキーボードショートカット

| ショートカット | 動作 |
|---|---|
| `Ctrl+T` | ウィンドウピッカーを開く（タブ追加） |
| `Ctrl+W` | アクティブなタブを閉じる |
| `Ctrl+Tab` | 次のタブへ切替 |
| `Ctrl+Shift+Tab` | 前のタブへ切替 |
| `Ctrl+1`〜`Ctrl+9` | 番号でタブを直接切替 |
| `Alt+P` | コマンドパレットを開く |

ホットキーは 設定 → **ホットキー** でカスタマイズできます。

---

## 設定

設定タブ（歯車アイコン）から以下を変更できます。

| 設定項目 | 説明 |
|---|---|
| タブ位置 | 上 / 下 / 左 / 右 |
| アクセントカラー | UI のアクセント色 |
| 背景色 | コンテンツ領域の背景色 |
| 閉じるときの動作 | タブを閉じるときにアプリを終了 / 解放 / Windowz を終了 |
| 終了時のウィンドウ処理 | 何もしない / すべて閉じる / スタートアップ分だけ閉じる |
| 管理者として実行 | Windowz を管理者権限で起動（管理者アプリの埋め込みに必要） |
| 自動埋め込み | 新しく出現したウィンドウを自動でタブに追加 |

設定ファイルは `%APPDATA%\Windowz\settings.json` に保存されます。

---

## 注意事項

- 管理者権限で動作しているアプリを埋め込むには、Windowz 自身も管理者として実行する必要があります。
- UWP アプリ（Microsoft Store アプリの一部）はウィンドウ構造の制約から埋め込みできない場合があります。
- `SetParent` を使用しないため、タブを切り替えるたびに対象ウィンドウの Z オーダーを操作します。ごく一部のアプリでは描画の乱れが生じる場合があります。
